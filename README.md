# ModeraFlow SaaS Dashboard

A modern, React-based SaaS dashboard for social media moderation. This project integrates with Supabase for the backend/vector store and n8n for workflow automation.

## Features

- **Dashboard**: Real-time analytics of moderation volume and sentiment.
- **Product Catalog**: Manage inventory for RAG (Retrieval Augmented Generation) grounding. Supports CSV Import/Export.
- **Integrations**: Connect Facebook Pages (simulated SDK wrapper).
- **AI Simulator**: Test system prompts and moderation logic using Gemini API directly in the browser.
- **User Management**: Admin interface to manage tenants and roles.
- **Settings**: Manage user profile and organization API configurations.

## Prerequisites

- **Node.js**: v18 or higher.
- **Supabase Project**: You need a Supabase project for Auth and Database.
- **Gemini API Key**: For the AI Simulator.

## Installation

1.  Clone the repository (or download the files).
2.  Install dependencies:
    ```bash
    npm install
    ```
    *Note: If using the provided `index.html` with ESM imports, no `npm install` is strictly necessary to run via a simple HTTP server, but a build tool like Vite is recommended for development.*

## Running Locally

This project is built using standard React and TypeScript.

### Option A: Using Vite (Recommended)
1.  Initialize a Vite project in the root:
    ```bash
    npm create vite@latest . -- --template react-ts
    npm install
    ```
2.  Install required packages:
    ```bash
    npm install lucide-react recharts react-router-dom @supabase/supabase-js @google/genai
    ```
3.  Start the development server:
    ```bash
    npm run dev
    ```

### Option B: Simple HTTP Server
Since the `index.html` uses `esm.sh` imports, you can serve the directory using any static file server:

```bash
npx serve .
```

## Environment Variables

Create a `.env` file (if using a build tool) or ensure your environment supports:

- `API_KEY`: Your Google Gemini API Key (required for the Simulator).

## Supabase Schema

To make the app function fully, run the following SQL in your Supabase SQL Editor:

```sql
-- Create Tenants Table
create table tenants (
  id uuid references auth.users not null primary key,
  org_name text,
  role text default 'user',
  plan text default 'Free',
  email text,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null
);

-- Create Products Table
create table products (
  id bigint generated by default as identity primary key,
  user_id uuid references auth.users not null,
  name text not null,
  description text,
  sku text,
  price numeric,
  category text,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null
);

-- Create App Settings Table
create table app_settings (
  user_id uuid references auth.users not null primary key,
  n8n_webhook_url text,
  n8n_webhook_secret text,
  supabase_url text,
  supabase_key text,
  facebook_app_id text,
  updated_at timestamp with time zone default timezone('utc'::text, now()) not null
);

-- Trigger to auto-create tenant on signup
create or replace function public.handle_new_user()
returns trigger as $$
begin
  insert into public.tenants (id, email, org_name, role)
  values (new.id, new.email, new.raw_user_meta_data->>'org_name', coalesce(new.raw_user_meta_data->>'role', 'user'));
  return new;
end;
$$ language plpgsql security definer;

create trigger on_auth_user_created
  after insert on auth.users
  for each row execute procedure public.handle_new_user();
```
